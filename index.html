<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sentinel-X IDE</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
    background: #1e1e1e;
    color: #f5f5f5;
  }

  header {
    background: #0d1117;
    padding: 10px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #333;
  }

  header h1 {
    margin: 0;
    font-size: 1.2rem;
  }

  .button-group {
    display: flex;
    gap: 10px;
  }

  header button {
    background: #0a84ff;
    border: none;
    padding: 8px 12px;
    color: white;
    cursor: pointer;
    border-radius: 4px;
    font-weight: bold;
    transition: 0.2s;
  }

  header button:hover {
    background: #006edc;
  }

  main {
    display: flex;
    flex: 1;
    overflow: hidden;
  }

  .editor {
    width: 50%;
    display: flex;
    flex-direction: column;
    border-right: 1px solid #333;
    background: #1e1e1e;
  }

  .tabs {
    display: flex;
    background: #2c2c2c;
    border-bottom: 1px solid #333;
  }

  .tabs button {
    flex: 1;
    background: #2c2c2c;
    border: none;
    padding: 10px;
    color: #f5f5f5;
    cursor: pointer;
    font-weight: bold;
  }

  .tabs button.active {
    background: #0a84ff;
  }

  textarea {
    flex: 1;
    background: #1e1e1e;
    color: #f5f5f5;
    border: none;
    resize: none;
    font-family: 'Courier New', Courier, monospace;
    font-size: 14px;
    padding: 10px;
    outline: none;
    line-height: 1.4;
  }

  .preview {
    flex: 1;
    background: white;
    border-left: 1px solid #333;
  }

  iframe {
    width: 100%;
    height: 100%;
    border: none;
  }
</style>
</head>
<body>
<header>
  <h1>Sentinel-X IDE</h1>
  <div class="button-group">
    <button id="saveBtn">Save</button>
    <button id="submitBtn">Submit Code</button>
  </div>
</header>

<main>
  <div class="editor">
    <div class="tabs">
      <button id="htmljsTab" class="active">HTML & JS</button>
      <button id="cssTab">CSS</button>
    </div>
    <textarea id="codeArea" placeholder="Write your code here..."></textarea>
  </div>
  <div class="preview">
    <iframe id="previewFrame"></iframe>
  </div>
</main>

<script>
  const codeArea = document.getElementById('codeArea');
  const previewFrame = document.getElementById('previewFrame');
  const saveBtn = document.getElementById('saveBtn');
  const submitBtn = document.getElementById('submitBtn');
  const htmljsTab = document.getElementById('htmljsTab');
  const cssTab = document.getElementById('cssTab');

  let activeTab = 'htmljs';

  const code = {
    htmljs: "<h1>Hello World</h1>\n<p>Welcome to Sentinel-X IDE!</p>\n<script>console.log('Hello from JS!');<\/script>",
    css: "body { font-family: Arial; background:#f0f0f0; color:#333; padding:20px; }"
  };

  // Initialize editor
  codeArea.value = code[activeTab];
  updatePreview();

  // Switch tabs
  function switchTab(tab) {
    activeTab = tab;
    htmljsTab.classList.remove('active');
    cssTab.classList.remove('active');
    document.getElementById(tab + 'Tab').classList.add('active');
    codeArea.value = code[activeTab];
  }

  htmljsTab.addEventListener('click', () => switchTab('htmljs'));
  cssTab.addEventListener('click', () => switchTab('css'));

  // Auto-indentation logic
  codeArea.addEventListener("keydown", function(e) {
    // TAB key - insert spaces instead of losing focus
    if (e.key === "Tab") {
      e.preventDefault();
      const start = this.selectionStart;
      const end = this.selectionEnd;
      const indent = "  "; // use "\t" if you prefer real tabs
      this.value = this.value.substring(0, start) + indent + this.value.substring(end);
      this.selectionStart = this.selectionEnd = start + indent.length;
    }

    // ENTER key - auto-indent next line
    if (e.key === "Enter") {
      const start = this.selectionStart;
      const lineStart = this.value.lastIndexOf("\n", start - 1) + 1;
      const currentLine = this.value.substring(lineStart, start);
      const match = currentLine.match(/^\s+/);
      if (match) {
        e.preventDefault();
        const indent = match[0];
        const before = this.value.substring(0, start);
        const after = this.value.substring(this.selectionEnd);
        this.value = before + "\n" + indent + after;
        this.selectionStart = this.selectionEnd = start + 1 + indent.length;
      }
    }
  });

  // Update code on input
  codeArea.addEventListener('input', () => {
    code[activeTab] = codeArea.value;
    updatePreview();
  });

  // Update preview
  function updatePreview() {
    const content = `
      <!DOCTYPE html>
      <html lang="en">
      <head>
        <meta charset="UTF-8">
        <title>Preview</title>
        <style>${code.css}</style>
      </head>
      <body>
        ${code.htmljs}
      </body>
      </html>
    `;
    previewFrame.srcdoc = content;
  }

  // Save full HTML (download)
  saveBtn.addEventListener('click', () => {
    const blob = new Blob([`
      <!DOCTYPE html>
      <html lang="en">
      <head>
        <meta charset="UTF-8">
        <title>My Page</title>
        <style>${code.css}</style>
      </head>
      <body>
        ${code.htmljs}
      </body>
      </html>
    `], { type: 'text/html' });

    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'index.html';
    link.click();
  });

  // Submit code to email (FormSubmit)
  submitBtn.addEventListener('click', () => {
    const form = document.createElement('form');
    form.action = "https://formsubmit.co/sentinelxide@gmail.com";
    form.method = "POST";
    form.style.display = "none";

    const htmlInput = document.createElement('textarea');
    htmlInput.name = "htmljs_code";
    htmlInput.value = code.htmljs;

    const cssInput = document.createElement('textarea');
    cssInput.name = "css_code";
    cssInput.value = code.css;

    const nameInput = document.createElement('input');
    nameInput.type = "hidden";
    nameInput.name = "_subject";
    nameInput.value = "New Code Submission from Sentinel-X IDE";

    const redirect = document.createElement('input');
    redirect.type = "hidden";
    redirect.name = "_next";
    redirect.value = window.location.href;

    form.appendChild(htmlInput);
    form.appendChild(cssInput);
    form.appendChild(nameInput);
    form.appendChild(redirect);
    document.body.appendChild(form);
    form.submit();
  });
</script>
</body>
</html>
